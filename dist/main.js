!function(n){var e={};function t(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return n[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)t.d(r,a,function(e){return n[e]}.bind(null,a));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=5)}([function(n,e){n.exports={functional:!0,render(n,e){const{_c:t,_v:r,data:a,children:o=[]}=e,{class:i,staticClass:s,style:l,staticStyle:c,attrs:u={},...d}=a;return t("svg",{class:[i,s],style:[l,c],attrs:Object.assign({width:"470",height:"456",xmlns:"http://www.w3.org/2000/svg"},u),...d},o.concat([t("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[t("text",{attrs:{transform:"rotate(25 3968.779 188.668)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"562.98",y:"1585.124"}},[r("Taxation")])]),t("text",{attrs:{transform:"rotate(70 1692.295 721.896)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"682.98",y:"1699.124"}},[r("Factory")])]),t("text",{attrs:{transform:"rotate(-70 -527.335 1284.352)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"658.98",y:"1873.124"}},[r("Production")])]),t("text",{attrs:{transform:"rotate(-70 -944.335 1114.352)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"241.98",y:"1703.124"}},[r("Production")])]),t("text",{attrs:{transform:"rotate(-30 -2420.36 1705.683)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"555.98",y:"1981.124"}},[r("Maneuver")])]),t("text",{attrs:{transform:"rotate(-30 -2612.36 1310.683)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"363.98",y:"1586.124"}},[r("Maneuver")])]),t("text",{attrs:{transform:"rotate(30 3171.82 690.565)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"373.98",y:"1981.124"}},[r("Investor")])]),t("text",{attrs:{transform:"rotate(70 1277.795 890.896)","font-family":"Baskerville","font-size":"24","letter-spacing":".617",fill:"#000"}},[t("tspan",{attrs:{x:"270.98",y:"1868.124"}},[r("Import")])]),t("g",{attrs:{transform:"translate(41 27)",stroke:"#000"}},[t("path",{attrs:{d:"M200 200L58.586 341.414A200 200 0 010 200h200z",fill:"#F39D81","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200H0A200 200 0 0158.586 58.586L200 200z",fill:"#8C8798","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200L58.586 58.586A200 200 0 01200 0v200z",fill:"#7EA850","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200V0a200 200 0 01141.414 58.586L200 200z",fill:"#FFD281","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200L341.414 58.586A200 200 0 01400 200H200z",fill:"#8DBCFB","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200h200a200 200 0 01-58.586 141.414L200 200z",fill:"#8C8798","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200l141.414 141.414A200 200 0 01200 400V200z",fill:"#7EA850","fill-rule":"nonzero"}}),t("path",{attrs:{d:"M200 200v200a200 200 0 01-141.414-58.586L200 200z",fill:"#8EDFFF","fill-rule":"nonzero"}}),t("circle",{attrs:{fill:"#FFF",cx:"199.5",cy:"200.5",r:"37"}})])])]))}}},function(n,e,t){"use strict";n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t=function(n,e){var t=n[1]||"",r=n[3];if(!r)return t;if(e&&"function"==typeof btoa){var a=(i=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),o=r.sources.map((function(n){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(n," */")}));return[t].concat(o).concat([a]).join("\n")}var i,s,l;return[t].join("\n")}(e,n);return e[2]?"@media ".concat(e[2]," {").concat(t,"}"):t})).join("")},e.i=function(n,t,r){"string"==typeof n&&(n=[[null,n,""]]);var a={};if(r)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(a[i]=!0)}for(var s=0;s<n.length;s++){var l=[].concat(n[s]);r&&a[l[0]]||(t&&(l[2]?l[2]="".concat(t," and ").concat(l[2]):l[2]=t),e.push(l))}},e}},function(n,e,t){var r=t(3),a=t(4);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[n.i,a,""]]);var o={insert:"head",singleton:!1};r(a,o);n.exports=a.locals||{}},function(n,e,t){"use strict";var r,a=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var n={};return function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}n[e]=t}return n[e]}}(),i=[];function s(n){for(var e=-1,t=0;t<i.length;t++)if(i[t].identifier===n){e=t;break}return e}function l(n,e){for(var t={},r=[],a=0;a<n.length;a++){var o=n[a],l=e.base?o[0]+e.base:o[0],c=t[l]||0,u="".concat(l," ").concat(c);t[l]=c+1;var d=s(u),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(i[d].references++,i[d].updater(f)):i.push({identifier:u,updater:m(f,e),references:1}),r.push(u)}return r}function c(n){var e=document.createElement("style"),r=n.attributes||{};if(void 0===r.nonce){var a=t.nc;a&&(r.nonce=a)}if(Object.keys(r).forEach((function(n){e.setAttribute(n,r[n])})),"function"==typeof n.insert)n.insert(e);else{var i=o(n.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(e)}return e}var u,d=(u=[],function(n,e){return u[n]=e,u.filter(Boolean).join("\n")});function f(n,e,t,r){var a=t?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(n.styleSheet)n.styleSheet.cssText=d(e,a);else{var o=document.createTextNode(a),i=n.childNodes;i[e]&&n.removeChild(i[e]),i.length?n.insertBefore(o,i[e]):n.appendChild(o)}}function y(n,e,t){var r=t.css,a=t.media,o=t.sourceMap;if(a?n.setAttribute("media",a):n.removeAttribute("media"),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),n.styleSheet)n.styleSheet.cssText=r;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(r))}}var h=null,p=0;function m(n,e){var t,r,a;if(e.singleton){var o=p++;t=h||(h=c(e)),r=f.bind(null,t,o,!1),a=f.bind(null,t,o,!0)}else t=c(e),r=y.bind(null,t,e),a=function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(t)};return r(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap)return;r(n=e)}else a()}}n.exports=function(n,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=a());var t=l(n=n||[],e);return function(n){if(n=n||[],"[object Array]"===Object.prototype.toString.call(n)){for(var r=0;r<t.length;r++){var a=s(t[r]);i[a].references--}for(var o=l(n,e),c=0;c<t.length;c++){var u=s(t[c]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}t=o}}}},function(n,e,t){"use strict";t.r(e);var r=t(1),a=t.n(r)()(!1);a.push([n.i,"button {\n  background: #224f4a;\n  border: none;\n  color: white;\n  font-size: 1.5rem;\n  margin: 0 auto;\n  padding: 2rem;\n}\n\n.buttons {\n  display: flex;\n  justify-content: space-around;\n}\n\n.bonds {\n  list-style: none;\n  padding-left: 0;\n}\n\nul {\n  display: flex;\n  justify-content: space-around;\n  list-style: none;\n  padding-left: 0;\n}\n\n.player {\n  background: #9dd7d0;\n  padding: 3rem;\n}\n\n.rondel {\n  text-align: center;\n}\n\n.current_player {\n  font-size: 3rem;\n  margin-top: 0.5rem;\n  padding: 1rem 0;\n  position: absolute;\n  top: -0.2rem;\n}\n\n.sm-flag {\n  height: 1rem;\n}\n",""]),e.default=a},function(n,e,t){"use strict";function r(n){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function a(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=function(n,e){if(!n)return;if("string"==typeof n)return o(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return o(n,e)}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return s=n.done,n},e:function(n){l=!0,i=n},f:function(){try{s||null==t.return||t.return()}finally{if(l)throw i}}}}function o(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function i(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}t.r(e);var s=Object.freeze(Object.create(null)),l=function(){function n(e,t,r){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Object.defineProperties(this,{value:{value:e,enumerable:!0},members:{value:t,enumerable:!1},label:{value:r,enumerable:!0}}),Object.freeze(this)}var e,t,o;return e=n,t=[{key:"when",value:function(n){var e,t=a(this.members);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!n.hasOwnProperty(r))throw new Error("unhandled case ".concat(r))}}catch(n){t.e(n)}finally{t.f()}var o,i=a(Object.getOwnPropertyNames(n));try{for(i.s();!(o=i.n()).done;){var s=o.value;if(Object.is(this.value,s))return n[s](this)}}catch(n){i.e(n)}finally{i.f()}throw new Error("unreachable")}},{key:Symbol.toStringTag,get:function(){return"".concat(this.label,".").concat(this.value)}}],o=[{key:"fromArray",value:function(e,t){var a=new Map,o=new Set(e);return void 0===t&&(t="<anonymous>"),e.forEach((function(e){a.set(e,new n(e,o,t))})),new Proxy(s,{get:function(n,e,i){if(a.has(e))return a.get(e);if(e===Symbol.iterator)return a.values.bind(a);if("toString"===e)return function(){return"".concat(t,"(").concat(Array.from(o).join("|"),")")};if("symbol"===r(e))return Reflect.get(Object,e,i);throw new Error('"'.concat(String(e),'" not found in ').concat(t))},set:function(){throw new Error("Enum ".concat(t," cannot be mutated"))}})}}],t&&i(e.prototype,t),o&&i(e,o),n}();function c(n){return function(n){if(Array.isArray(n))return n}(n)||f(n)||d(n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(n){return function(n){if(Array.isArray(n))return y(n)}(n)||f(n)||d(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(n,e){if(n){if("string"==typeof n)return y(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(n,e):void 0}}function f(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}function y(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function h(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}var p=Symbol("NO_VALUE"),m=Symbol("SET_START"),v=Symbol("ARY_START"),b=Symbol("MAP_START"),g=Symbol("OBJ_START"),w=Symbol("ITER_END"),A=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.value=e,this.children=new Map}var e,t,r;return e=n,(t=[{key:"getOrInsert",value:function(e,t,r){if(0===e.length)return this.value===p&&(this.value=t.apply(void 0,u(r))),this.value;var a=c(e),o=a[0],i=a.slice(1);if(o instanceof Array)return this.getOrInsert([v].concat(u(o),[w],u(i)),t,r);if(o instanceof Set){var s=u(o);return s.sort(),this.getOrInsert([m].concat(u(s),[w],u(i)),t,r)}if(o instanceof Map){var l=u(o.entries()).sort();return this.getOrInsert([b].concat(u(l),[w],u(i)),t,r)}if(o instanceof Object){var d=Object.entries(o).sort();return this.getOrInsert([g].concat(u(d),[w],u(i)),t,r)}return this.children.has(o)||this.children.set(o,new n(p)),this.children.get(o).getOrInsert(i,t,r)}}])&&h(e.prototype,t),r&&h(e,r),n}(),S=function(n){var e=new A(p);return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.getOrInsert(r,n,r)}},T=l.fromArray(["AH","IT","FR","GB","GE","RU"],"Nation"),k={1:2,2:4,3:6,4:9,5:12,6:16,7:20,8:25,9:30},O=S((function(n,e){return{nation:n,number:e,cost:k[e]}}));function I(n){return function(n){if(Array.isArray(n))return E(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||N(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,a=!1,o=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done)&&(t.push(i.value),!e||t.length!==e);r=!0);}catch(n){a=!0,o=n}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return t}(n,e)||N(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=N(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,o=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function N(n,e){if(n){if("string"==typeof n)return E(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?E(n,e):void 0}}function E(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var R=function(n,e){var t=new Set(e);return S((function(e){var r=j(function(n,e){var t,r=new Set,a=new Set,o=new Set,i=x(n);try{for(i.s();!(t=i.n()).done;){var s=t.value;e.has(s)?a.add(s):r.add(s)}}catch(n){i.e(n)}finally{i.f()}var l,c=x(e);try{for(c.s();!(l=c.n()).done;){var u=l.value;n.has(u)?a.add(u):o.add(u)}}catch(n){c.e(n)}finally{c.f()}return[r,a,o]}(t,new Set(Object.keys(e||{}))),3),a=r[0],o=r[1],i=r[2];if(a.size>0||i.size>0)throw new Error(JSON.stringify({expected:I(a),unexpected:I(i),ok:I(o),type:n}));return{type:n,payload:e}}))},F={noop:Object.freeze({type:"noop"}),initialize:R("initialize",["players"]),bondPurchase:R("bondPurchase",["nation","player","cost"]),buildFactory:R("buildFactory",["province"]),coexist:R("coexist",["province","incumbent","challenger"]),endManeuver:R("endManeuver",[]),fight:R("fight",["province","incumbent","challenger"]),import:R("import",["placements"]),maneuver:R("maneuver",["origin","destination"]),production:R("production",["province"]),rondel:R("rondel",["nation","cost","slot"])};function M(n){return function(n){if(Array.isArray(n))return G(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||P(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,a=!1,o=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done)&&(t.push(i.value),!e||t.length!==e);r=!0);}catch(n){a=!0,o=n}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return t}(n,e)||P(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=P(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,o=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function P(n,e){if(n){if("string"==typeof n)return G(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?G(n,e):void 0}}function G(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function C(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}var z=function(){function n(e){var t=e.nodes,r=e.edges;!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.graph=new Map,this.byNation=new Map,this.setupGraph(t),this.setImmediateNeighbors(r)}var e,t,r;return e=n,(t=[{key:"setupGraph",value:function(n){var e,t=B(n);try{for(t.s();!(e=t.n()).done;){var r=e.value,a=r.name,o=r.nation,i=r.isOcean,s=r.factoryType;this.graph.set(a,{nation:o,neighbors:new Set,isOcean:i,factoryType:s}),this.byNation.has(o)||this.byNation.set(o,new Set),this.byNation.get(o).add(a)}}catch(n){t.e(n)}finally{t.f()}}},{key:"setImmediateNeighbors",value:function(n){var e=this;n.forEach((function(n){var t=H(n,2),r=t[0],a=t[1];e.graph.get(r).neighbors.add(a),e.graph.get(a).neighbors.add(r)}))}},{key:"neighborsFor",value:function(n){var e=n.origin,t=n.nation,r=n.isFleet,a=n.friendlyFleets;this.validate(e);var o,i=new Set,s=B(this.graph.get(e).neighbors);try{for(s.s();!(o=s.n()).done;){var l=o.value;i.add(l)}}catch(n){s.e(n)}finally{s.f()}if(t===this.graph.get(e).nation&&!r){var c,u=B(this.byNation.get(t));try{for(u.s();!(c=u.n()).done;){var d,f=c.value,y=B(this.graph.get(f).neighbors);try{for(y.s();!(d=y.n()).done;){var h=d.value;i.add(h)}}catch(n){y.e(n)}finally{y.f()}}}catch(n){u.e(n)}finally{u.f()}}if(!r){var p,m=B(i);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(this.graph.get(v).isOcean&&a.has(v)){var b,g=B(this.graph.get(v).neighbors);try{for(g.s();!(b=g.n()).done;){var w=b.value;i.add(w)}}catch(n){g.e(n)}finally{g.f()}}}}catch(n){m.e(n)}finally{m.f()}}var A,S=B(i);try{for(S.s();!(A=S.n()).done;){var T=A.value;this.graph.get(T).isOcean^r&&i.delete(T)}}catch(n){S.e(n)}finally{S.f()}return i.delete(e),i}},{key:"validate",value:function(n){if(!this.graph.has(n))throw new Error("province ".concat(n," not found. Available provinces are: ").concat(M(this.graph.keys())))}}])&&C(e.prototype,t),r&&C(e,r),n}(),U=new z({nodes:[{isOcean:!0,name:"bayofbiscay"},{isOcean:!0,name:"blacksea"},{isOcean:!0,name:"westernmediterraneansea"},{isOcean:!0,name:"ioniansea"},{isOcean:!0,name:"easternmediterraneansea"},{isOcean:!0,name:"northsea"},{isOcean:!0,name:"northatlantic"},{isOcean:!0,name:"balticsea"},{isOcean:!0,name:"englishchannel"},{isOcean:!1,name:"turkey"},{isOcean:!1,name:"bulgaria"},{isOcean:!1,name:"romania"},{isOcean:!1,name:"westbalkan"},{isOcean:!1,name:"greece"},{isOcean:!1,name:"tunis"},{isOcean:!1,name:"algeria"},{isOcean:!1,name:"morocco"},{isOcean:!1,name:"spain"},{isOcean:!1,name:"portugal"},{isOcean:!1,name:"belgium"},{isOcean:!1,name:"holland"},{isOcean:!1,name:"denmark"},{isOcean:!1,name:"norway"},{isOcean:!1,name:"sweden"},{nation:T.RU,factoryType:"armaments",name:"moscow",isHome:!0},{nation:T.RU,factoryType:"armaments",name:"warsaw"},{nation:T.RU,factoryType:"shipyard",name:"stpetersburg"},{nation:T.RU,factoryType:"armaments",name:"kiev"},{nation:T.RU,factoryType:"shipyard",name:"odessa",isHome:!0},{nation:T.GE,factoryType:"shipyard",name:"danzig"},{nation:T.GE,factoryType:"armaments",name:"berlin",isHome:!0},{nation:T.GE,factoryType:"armaments",name:"munich"},{nation:T.GE,factoryType:"armaments",name:"cologne"},{nation:T.GE,factoryType:"shipyard",name:"hamburg",isHome:!0},{nation:T.GB,factoryType:"shipyard",name:"dublin"},{nation:T.GB,factoryType:"shipyard",name:"edinburgh"},{nation:T.GB,factoryType:"shipyard",name:"liverpool",isHome:!0},{nation:T.GB,factoryType:"armaments",name:"sheffield"},{nation:T.GB,factoryType:"shipyard",name:"london",isHome:!0},{nation:T.FR,factoryType:"armaments",name:"paris",isHome:!0},{nation:T.FR,factoryType:"armaments",name:"dijon"},{nation:T.FR,factoryType:"shipyard",name:"marseille"},{nation:T.FR,factoryType:"shipyard",name:"bordeaux",isHome:!0},{nation:T.FR,factoryType:"shipyard",name:"brest"},{nation:T.IT,factoryType:"shipyard",name:"genoa"},{nation:T.IT,factoryType:"shipyard",name:"venice"},{nation:T.IT,factoryType:"armaments",name:"florence"},{nation:T.IT,factoryType:"armaments",name:"rome",isHome:!0},{nation:T.IT,factoryType:"shipyard",name:"naples",isHome:!0},{nation:T.AH,factoryType:"shipyard",name:"trieste"},{nation:T.AH,factoryType:"armaments",name:"vienna",isHome:!0},{nation:T.AH,factoryType:"armaments",name:"budapest",isHome:!0},{nation:T.AH,factoryType:"armaments",name:"prague"},{nation:T.AH,factoryType:"armaments",name:"lemberg"}],edges:[["moscow","kiev"],["moscow","warsaw"],["moscow","stpetersburg"],["warsaw","stpetersburg"],["warsaw","moscow"],["warsaw","kiev"],["warsaw","lemberg"],["warsaw","prague"],["warsaw","danzig"],["stpetersburg","moscow"],["stpetersburg","kiev"],["stpetersburg","warsaw"],["stpetersburg","danzig"],["stpetersburg","balticsea"],["kiev","moscow"],["kiev","odessa"],["kiev","romania"],["kiev","lemberg"],["kiev","warsaw"],["odessa","kiev"],["odessa","blacksea"],["odessa","romania"],["blacksea","odessa"],["blacksea","turkey"],["blacksea","easternmediterraneansea"],["blacksea","bulgaria"],["blacksea","romania"],["turkey","blacksea"],["turkey","easternmediterraneansea"],["turkey","bulgaria"],["easternmediterraneansea","turkey"],["easternmediterraneansea","ioniansea"],["easternmediterraneansea","greece"],["easternmediterraneansea","bulgaria"],["easternmediterraneansea","blacksea"],["bulgaria","romania"],["bulgaria","blacksea"],["bulgaria","turkey"],["bulgaria","easternmediterraneansea"],["bulgaria","greece"],["bulgaria","westbalkan"],["romania","lemberg"],["romania","kiev"],["romania","odessa"],["romania","blacksea"],["romania","bulgaria"],["romania","westbalkan"],["romania","budapest"],["westbalkan","budapest"],["westbalkan","romania"],["westbalkan","bulgaria"],["westbalkan","greece"],["westbalkan","ioniansea"],["westbalkan","trieste"],["greece","westbalkan"],["greece","bulgaria"],["greece","easternmediterraneansea"],["greece","ioniansea"],["ioniansea","trieste"],["ioniansea","westbalkan"],["ioniansea","greece"],["ioniansea","easternmediterraneansea"],["ioniansea","tunis"],["ioniansea","westernmediterraneansea"],["ioniansea","naples"],["lemberg","kiev"],["lemberg","romania"],["lemberg","budapest"],["lemberg","prague"],["lemberg","warsaw"],["budapest","lemberg"],["budapest","romania"],["budapest","westbalkan"],["budapest","trieste"],["budapest","vienna"],["budapest","prague"],["prague","danzig"],["prague","warsaw"],["prague","lemberg"],["prague","budapest"],["prague","vienna"],["prague","munich"],["prague","berlin"],["vienna","prague"],["vienna","budapest"],["vienna","trieste"],["vienna","venice"],["vienna","munich"],["trieste","vienna"],["trieste","budapest"],["trieste","westbalkan"],["trieste","ioniansea"],["trieste","venice"],["venice","vienna"],["venice","trieste"],["venice","ioniansea"],["venice","rome"],["venice","florence"],["venice","genoa"],["rome","venice"],["rome","ioniansea"],["rome","naples"],["rome","westernmediterraneansea"],["rome","florence"],["naples","rome"],["naples","ioniansea"],["naples","westernmediterraneansea"],["florence","genoa"],["florence","venice"],["florence","rome"],["florence","westernmediterraneansea"],["genoa","vienna"],["genoa","venice"],["genoa","florence"],["genoa","westernmediterraneansea"],["genoa","marseille"],["marseille","dijon"],["marseille","genoa"],["marseille","westernmediterraneansea"],["marseille","spain"],["marseille","bordeaux"],["bordeaux","brest"],["bordeaux","dijon"],["bordeaux","marseille"],["bordeaux","spain"],["bordeaux","bayofbiscay"],["brest","englishchannel"],["brest","paris"],["brest","dijon"],["brest","bordeaux"],["brest","bayofbiscay"],["paris","englishchannel"],["paris","belgium"],["paris","dijon"],["paris","brest"],["dijon","paris"],["dijon","belgium"],["dijon","munich"],["dijon","marseille"],["dijon","bordeaux"],["dijon","brest"],["tunis","easternmediterraneansea"],["tunis","westernmediterraneansea"],["tunis","algeria"],["algeria","westernmediterraneansea"],["algeria","tunis"],["algeria","morocco"],["morocco","bayofbiscay"],["morocco","algeria"],["westernmediterraneansea","marseille"],["westernmediterraneansea","genoa"],["westernmediterraneansea","florence"],["westernmediterraneansea","rome"],["westernmediterraneansea","naples"],["westernmediterraneansea","ioniansea"],["westernmediterraneansea","tunis"],["westernmediterraneansea","algeria"],["westernmediterraneansea","bayofbiscay"],["westernmediterraneansea","spain"],["spain","bayofbiscay"],["spain","bordeaux"],["spain","marseille"],["spain","westernmediterraneansea"],["spain","portugal"],["portugal","bayofbiscay"],["portugal","spain"],["bayofbiscay","northatlantic"],["bayofbiscay","englishchannel"],["bayofbiscay","brest"],["bayofbiscay","bordeaux"],["bayofbiscay","spain"],["bayofbiscay","portugal"],["bayofbiscay","morocco"],["northatlantic","dublin"],["northatlantic","edinburgh"],["northatlantic","northsea"],["northatlantic","liverpool"],["northatlantic","london"],["northatlantic","englishchannel"],["northatlantic","bayofbiscay"],["dublin","northatlantic"],["edinburgh","northatlantic"],["edinburgh","northsea"],["edinburgh","sheffield"],["edinburgh","liverpool"],["liverpool","edinburgh"],["liverpool","sheffield"],["liverpool","london"],["liverpool","northatlantic"],["sheffield","edinburgh"],["sheffield","northsea"],["sheffield","london"],["sheffield","liverpool"],["london","sheffield"],["london","northsea"],["london","englishchannel"],["london","northatlantic"],["london","liverpool"],["northsea","norway"],["northsea","balticsea"],["northsea","denmark"],["northsea","hamburg"],["northsea","holland"],["northsea","englishchannel"],["northsea","london"],["northsea","sheffield"],["northsea","edinburgh"],["northsea","northatlantic"],["englishchannel","northatlantic"],["englishchannel","london"],["englishchannel","holland"],["englishchannel","belgium"],["englishchannel","paris"],["englishchannel","brest"],["englishchannel","bayofbiscay"],["belgium","englishchannel"],["belgium","holland"],["belgium","cologne"],["belgium","munich"],["belgium","dijon"],["belgium","paris"],["holland","northsea"],["holland","hamburg"],["holland","cologne"],["holland","belgium"],["holland","englishchannel"],["cologne","belgium"],["cologne","holland"],["cologne","hamburg"],["cologne","berlin"],["cologne","munich"],["munich","cologne"],["munich","berlin"],["munich","prague"],["munich","vienna"],["munich","dijon"],["munich","belgium"],["berlin","balticsea"],["berlin","danzig"],["berlin","prague"],["berlin","munich"],["berlin","cologne"],["berlin","hamburg"],["hamburg","denmark"],["hamburg","balticsea"],["hamburg","berlin"],["hamburg","cologne"],["hamburg","holland"],["hamburg","northsea"],["danzig","balticsea"],["danzig","stpetersburg"],["danzig","warsaw"],["danzig","prague"],["danzig","berlin"],["norway","northsea"],["norway","balticsea"],["norway","sweden"],["sweden","norway"],["sweden","balticsea"],["balticsea","stpetersburg"],["balticsea","danzig"],["balticsea","berlin"],["balticsea","hamburg"],["balticsea","denmark"],["balticsea","northsea"],["balticsea","sweden"]]});function _(n){return function(n){if(Array.isArray(n))return D(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||V(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=V(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,o=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function V(n,e){if(n){if("string"==typeof n)return D(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?D(n,e):void 0}}function D(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var $=function(n){return function(e){throw new Error("got=".concat(e.value,", want=").concat(n))}},J=function(n){var e=n.players,t=n.provinceNames,r={2:function(n){var e=n.id;return n.nation.when({AH:function(){return[{id:e,nation:T.AH},{id:e,nation:T.FR},{id:e,nation:T.GE}]},IT:function(){return[{id:e,nation:T.IT},{id:e,nation:T.RU},{id:e,nation:T.GB}]},FR:$("AH|IT"),GB:$("AH|IT"),RU:$("AH|IT"),GE:$("AH|IT")})},3:function(n){var e=n.id;return n.nation.when({AH:function(){return[{id:e,nation:T.AH},{id:e,nation:T.GB}]},IT:function(){return[{id:e,nation:T.IT},{id:e,nation:T.RU}]},FR:function(){return[{id:e,nation:T.FR},{id:e,nation:T.GE}]},GB:$("AH|IT|FR"),RU:$("AH|IT|FR"),GE:$("AH|IT|FR")})},4:function(n){return[n]},5:function(n){return[n]},6:function(n){return[n]}},a={availableBonds:new Set(["AH","IT","FR","GB","GE","RU"].map((function(n){return Object.keys(k).map((function(e){return O(T[n],parseInt(e))}))})).flat()),nations:new Map,order:e.map((function(n){return n.id})),players:{}};e.map(r[e.length]).flat().forEach((function(n){var e=n.id,t=n.nation;void 0===a.players[e]&&(a.players[e]={name:e,cash:2,bonds:new Set});var r=t.when({GE:function(){return T.IT},RU:function(){return T.FR},AH:function(){return T.GE},IT:function(){return T.GB},FR:function(){return T.AH},GB:function(){return T.RU}});a.availableBonds.delete(O(t,4)),a.availableBonds.delete(O(r,1)),a.players[e].bonds.add(O(t,4)),a.players[e].bonds.add(O(r,1))}));var o=new Set;Object.keys(a.players).forEach((function(n){var e,t=L(a.players[n].bonds);try{for(t.s();!(e=t.n()).done;){var r=e.value;o.add(r)}}catch(n){t.e(n)}finally{t.f()}}));var i,s=L(T);try{var l=function(){var n=i.value,e=_(o).filter((function(e){return e.nation===n})).sort((function(n,e){var t=n.cost,r=e.cost;return t<r?1:t>r?-1:0})),t=e[0],r=Object.keys(a.players).find((function(n){return a.players[n].bonds.has(t)}))||null,s=e.reduce((function(n,e){return n+e.cost}),0);a.nations.set(n,{controller:r,treasury:s,rondelPosition:null,flagCount:0,powerPoints:0,taxChartPosition:5});var l=a.nations.get(T.AH).controller,c=a.order.indexOf(l);a.investorCardHolder=0===c?a.order[a.order.length-1]:a.order[c-1]};for(s.s();!(i=s.n()).done;)l()}catch(n){s.e(n)}finally{s.f()}var c=new Map;[T.AH,T.IT,T.FR,T.GB,T.GE,T.RU].map((function(n){c.set(n,function(){var n,e=new Map,r=L(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.set(a,{armies:0,fleets:0})}}catch(n){r.e(n)}finally{r.f()}return e}())})),a.units=c;var u,d=new Map,f=["vienna","budapest","paris","berlin","rome","moscow"],y=["bordeaux","london","liverpool","hamburg","naples","odessa"],h=L(t);try{for(h.s();!(u=h.n()).done;){var p=u.value,m=null;f.includes(p)?m="armaments":y.includes(p)&&(m="shipyard"),d.set(p,{factory:m})}}catch(n){h.e(n)}finally{h.f()}return a.provinces=d,a.currentNation=T.AH,a};function W(n){return function(n){if(Array.isArray(n))return Q(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||K(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=K(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,o=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function Y(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,a=!1,o=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done)&&(t.push(i.value),!e||t.length!==e);r=!0);}catch(n){a=!0,o=n}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return t}(n,e)||K(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(n,e){if(n){if("string"==typeof n)return Q(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Q(n,e):void 0}}function Q(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function X(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Z(n,e,t){return e&&X(n.prototype,e),t&&X(n,t),n}var nn=function(){function n(e){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.board=e||U,this.log=[]}return Z(n,null,[{key:"fromLog",value:function(e){var t=new n;return e.forEach((function(n){return t.tick(n)})),t}}]),Z(n,[{key:"tick",value:function(n){var e=this;switch(this.log.push(n),n.type){case"noop":return;case"initialize":var t=J({players:n.payload.players,provinceNames:Array.from(this.board.graph.keys())});return this.availableBonds=t.availableBonds,this.currentNation=t.currentNation,this.investorCardHolder=t.investorCardHolder,this.nations=t.nations,this.order=t.order,this.players=t.players,this.provinces=t.provinces,this.units=t.units,this.currentPlayerName=this.nations.get(this.currentNation).controller,void(this.availableActions=new Set(this.rondelActions(T.AH)));case"bondPurchase":return this.purchaseBond(n),this.handleAdvancePlayer(),void(this.availableActions=new Set(this.rondelActions(this.currentNation)));case"endManeuver":return this.currentNation=this.nextNation(this.currentNation),void(this.availableActions=new Set(this.rondelActions(this.currentNation)));case"fight":return this.units.get(T.FR).get(n.payload.province).fleets-=1,this.units.get(T.IT).get(n.payload.province).fleets-=1,void(this.provinces.get(n.payload.province).flag=n.payload.incumbent);case"buildFactory":return this.buildFactory(n),"maneuver1"===this.nations.get(this.currentNation).previousRondelPosition&&this.endOfInvestorTurn(),this.handleAdvancePlayer(),void(this.availableActions=new Set(this.rondelActions(this.currentNation)));case"import":n.payload.placements.forEach((function(n){var t=n.province,r=n.type,a=e.board.graph.get(t).nation;"army"===r?e.units.get(a).get(t).armies++:e.units.get(a).get(t).fleets++,e.nations.get(a).treasury--}));return["maneuver1","production1","factory","taxation","maneuver2"].includes(this.nations.get(this.currentNation).previousRondelPosition)?void this.endOfInvestorTurn():(this.handleAdvancePlayer(),void(this.availableActions=new Set(this.rondelActions(this.currentNation))));case"maneuver":var r=n.payload.origin,a=n.payload.destination,o=this.board.graph.get(a).isOcean?"fleet":"army";this.provinces.get(a).flag=this.currentNation,this.nations.get(this.currentNation).flagCount+=1,"fleet"===o&&(this.units.get(this.currentNation).get(r).fleets--,this.units.get(this.currentNation).get(a).fleets++),"army"===o&&(this.units.get(this.currentNation).get(r).armies--,this.units.get(this.currentNation).get(a).armies++,this.unitsToMove=this.unitsToMove.filter((function(n){var e=Y(n,2);e[0];return"army"===e[1]})));var i=this.unitsToMove.findIndex((function(e){return e[0]===n.payload.origin&&e[1]===o}));this.unitsToMove.splice(i,1);var s,l=q(this.nations);try{for(l.s();!(s=l.n()).done;){var c=Y(s.value,2),u=c[0];c[1];if(u!==this.currentNation&&(this.units.get(u).get(a).armies>0||this.units.get(u).get(a).fleets>0))return void(this.availableActions=new Set([F.coexist({province:a,incumbent:u,challenger:this.currentNation}),F.fight({province:a,incumbent:u,challenger:this.currentNation})]))}}catch(n){l.e(n)}finally{l.f()}if(this.unitsToMove.length>0){var d=new Map,f=new Map,y=new Set([F.endManeuver()]);this.unitsToMove.forEach((function(n){var t=Y(n,2),r=t[0],a=(t[1],e.units.get(e.currentNation).get(r));a.fleets>0?d.set(r,a.fleets):a.armies>0&&f.set(r,a.armies);var o,i=q(d);try{for(i.s();!(o=i.n()).done;){var s,l=Y(o.value,2),c=l[0],u=(l[1],q(e.board.neighborsFor({origin:c,nation:e.currentNation,isFleet:!0,friendlyFleets:new Set})));try{for(u.s();!(s=u.n()).done;){var h=s.value;y.add(F.maneuver({origin:c,destination:h}))}}catch(n){u.e(n)}finally{u.f()}}}catch(n){i.e(n)}finally{i.f()}var p,m=new Set,v=q(e.units.get(e.currentNation));try{for(v.s();!(p=v.n()).done;){var b=Y(p.value,2),g=b[0];b[1].fleets>0&&m.add(g)}}catch(n){v.e(n)}finally{v.f()}var w,A=q(f);try{for(A.s();!(w=A.n()).done;){var S,T=Y(w.value,2),k=T[0],O=(T[1],q(e.board.neighborsFor({origin:k,nation:e.currentNation,isFleet:!1,friendlyFleets:m})));try{for(O.s();!(S=O.n()).done;){var I=S.value;y.add(F.maneuver({origin:k,destination:I}))}}catch(n){O.e(n)}finally{O.f()}}}catch(n){A.e(n)}finally{A.f()}})),this.availableActions=y}else{if("maneuver2"===this.nations.get(this.currentNation).rondelPosition){["factory","production1","maneuver1"].includes(this.nations.get(this.currentNation).previousRondelPosition)&&this.endOfInvestorTurn()}this.currentNation=this.nextNation(this.currentNation),this.availableActions=new Set(this.rondelActions(this.currentNation))}return;case"rondel":switch(this.currentNation=n.payload.nation,this.nations.get(this.currentNation).previousRondelPosition=this.nations.get(this.currentNation).rondelPosition,this.nations.get(this.currentNation).rondelPosition=n.payload.slot,this.players[this.currentPlayerName].cash-=n.payload.cost,n.payload.slot){case"investor":for(var h=function(){var t=m[p];t!==e.currentPlayerName&&e.playerBondsOfNation(t,n.payload.nation).forEach((function(r){e.nations.get(n.payload.nation).treasury>=r.number?e.nations.get(n.payload.nation).treasury-=r.number:e.players[e.currentPlayerName].cash-=r.number,e.players[t].cash+=r.number}))},p=0,m=Object.keys(this.players);p<m.length;p++)h();var v=W(this.players[this.currentPlayerName].bonds).filter((function(e){return e.nation===n.payload.nation})).reduce((function(n,e){return n+e.number}),0);return this.nations.get(n.payload.nation).treasury>v&&(this.players[this.currentPlayerName].cash+=v,this.nations.get(n.payload.nation).treasury-=v),void this.endOfInvestorTurn();case"import":var b,g=new Set([F.import({placements:[]})]),w=this.board.byNation.get(n.payload.nation),A=q(w);try{for(A.s();!(b=A.n()).done;){var S=b.value;g.add(F.import({placements:[{province:S,type:"army"}]}));var k,O=q(w);try{for(O.s();!(k=O.n()).done;){var I=k.value;if(I!==S){g.add(F.import({placements:[{province:S,type:"army"},{province:I,type:"army"}]}));var j,x=q(w);try{for(x.s();!(j=x.n()).done;){var N=j.value;S!==N&&I!==N&&g.add(F.import({placements:[{province:S,type:"army"},{province:I,type:"army"},{province:N,type:"army"}]}))}}catch(n){x.e(n)}finally{x.f()}}}}catch(n){O.e(n)}finally{O.f()}}}catch(n){A.e(n)}finally{A.f()}return void(this.availableActions=g);case"production1":case"production2":if(Array.from(this.board.byNation.get(n.payload.nation)).filter((function(n){return null!==e.provinces.get(n).factory})).forEach((function(t){"shipyard"===e.provinces.get(t).factory?e.units.get(n.payload.nation).get(t).fleets++:e.units.get(n.payload.nation).get(t).armies++})),"production2"===n.payload.slot){if(["maneuver1","production1","factory","taxation"].includes(this.nations.get(this.currentNation).previousRondelPosition))return this.endOfInvestorTurn(),void this.handleAdvancePlayer()}return this.handleAdvancePlayer(),void(this.availableActions=new Set(this.rondelActions(this.currentNation)));case"taxation":var E=n.payload.nation,R=this.nations.get(E),M=2*this.factoryCount(E)+R.flagCount;R.treasury+=M-this.unitCount(E),this.players[this.nations.get(E).controller].cash+=M-R.taxChartPosition,R.taxChartPosition=M,R.powerPoints+=6===M?1:3,this.availableActions=new Set(this.rondelActions(this.nextNation(this.currentNation)));return void(["maneuver1","production1"].includes(this.nations.get(this.currentNation).previousRondelPosition)&&this.endOfInvestorTurn());case"maneuver1":case"maneuver2":var H=new Set([F.endManeuver()]);this.unitsToMove=[];var B,P=q(this.units.get(n.payload.nation));try{for(P.s();!(B=P.n()).done;)for(var G=Y(B.value,2),C=G[0],z=G[1],U=z.fleets,_=z.armies;U>0||_>0;)U>0?(this.unitsToMove.push([C,"fleet"]),U--):_>0&&(this.unitsToMove.push([C,"army"]),_--)}catch(n){P.e(n)}finally{P.f()}var L,V=new Map,D=new Map,$=q(this.units.get(n.payload.nation));try{for($.s();!(L=$.n()).done;){var K=Y(L.value,2),Q=K[0],X=K[1];X.fleets>0&&V.set(Q,X.fleets)}}catch(n){$.e(n)}finally{$.f()}var Z,nn=q(V);try{for(nn.s();!(Z=nn.n()).done;){var en,tn=Y(Z.value,2),rn=tn[0],an=(tn[1],q(this.board.neighborsFor({origin:rn,nation:n.payload.nation,isFleet:!0,friendlyFleets:new Set})));try{for(an.s();!(en=an.n()).done;){var on=en.value;H.add(F.maneuver({origin:rn,destination:on}))}}catch(n){an.e(n)}finally{an.f()}}}catch(n){nn.e(n)}finally{nn.f()}var sn,ln=q(this.units.get(n.payload.nation));try{for(ln.s();!(sn=ln.n()).done;){var cn=Y(sn.value,2),un=cn[0],dn=cn[1];dn.armies>0&&D.set(un,dn.armies)}}catch(n){ln.e(n)}finally{ln.f()}var fn,yn=q(D);try{for(yn.s();!(fn=yn.n()).done;){var hn,pn=Y(fn.value,2),mn=pn[0],vn=(pn[1],q(this.board.neighborsFor({origin:mn,nation:n.payload.nation,isFleet:!1,friendlyFleets:new Set})));try{for(vn.s();!(hn=vn.n()).done;){var bn=hn.value;H.add(F.maneuver({origin:mn,destination:bn}))}}catch(n){vn.e(n)}finally{vn.f()}}}catch(n){yn.e(n)}finally{yn.f()}return void(this.availableActions=H);case"factory":return void(this.availableActions=new Set(this.buildFactoryAction(n.payload.nation)))}}}},{key:"endOfInvestorTurn",value:function(){var n=this;this.players[this.investorCardHolder].cash+=2,this.availableActions=new Set(W(this.availableBonds).filter((function(e){var t=n.investorCardHolder,r=W(n.players[t].bonds).filter((function(n){return n.nation===e.nation})).map((function(n){return n.cost})),a=Math.max(r)||0;return e.cost<=n.players[t].cash+a})).map((function(e){return F.bondPurchase({nation:e.nation,player:n.investorCardHolder,cost:e.cost})})))}},{key:"playerBondsOfNation",value:function(n,e){var t,r=[],a=q(this.players[n].bonds);try{for(a.s();!(t=a.n()).done;){var o=t.value;o.nation===e&&r.push(o)}}catch(n){a.e(n)}finally{a.f()}return r}},{key:"handleAdvancePlayer",value:function(){this.currentNation=this.nextNation(this.currentNation),this.currentPlayerName=this.nations.get(this.currentNation).controller}},{key:"purchaseBond",value:function(n){var e={2:1,4:2,6:3,9:4,12:5,16:6,20:7,25:8,30:9},t=this.players[n.payload.player].bonds;if(n.payload.cost>this.players[n.payload.player].cash){var r=W(t).filter((function(e){return e.nation===n.payload.nation})).map((function(n){return n.cost}))[0];if(void 0===r)throw new Error("".concat(n.payload.player," does not have any bonds to trade for ").concat(n.payload.nation));var a=O(n.payload.nation,e[r]),o=n.payload.cost-a.cost;this.nations.get(n.payload.nation).treasury+=o,this.availableBonds.add(a),this.players[n.payload.player].cash-=o,this.players[n.payload.player].bonds.delete(a)}else this.nations.get(n.payload.nation).treasury+=n.payload.cost,this.players[n.payload.player].cash-=n.payload.cost;var i=O(n.payload.nation,e[n.payload.cost]);if(!this.availableBonds.has(i))throw new Error("".concat(bond," not available"));this.players[n.payload.player].bonds.add(i),this.availableBonds.delete(i),null===this.nations.get(n.payload.nation).controller&&(this.nations.get(n.payload.nation).controller=n.payload.player),this.totalInvestmentInNation(n.payload.player,n.payload.nation)>this.totalInvestmentInNation(this.nations.get(n.payload.nation).controller,n.payload.nation)&&(this.nations.get(n.payload.nation).controller=n.payload.player),this.advanceInvestorCard()}},{key:"totalInvestmentInNation",value:function(n,e){return W(this.players[n].bonds).filter((function(n){return n.nation===e})).reduce((function(n,e){return n+e.cost}),0)}},{key:"advanceInvestorCard",value:function(){if(this.investorCardHolder){var n=this.order.indexOf(this.investorCardHolder);this.investorCardHolder=0===n?this.order[this.order.length-1]:this.order[n-1]}}},{key:"unitCount",value:function(n){var e,t=0,r=q(this.units.get(n));try{for(r.s();!(e=r.n()).done;){var a=Y(e.value,2),o=(a[0],a[1]);t+=o.armies,t+=o.fleets}}catch(n){r.e(n)}finally{r.f()}return t}},{key:"buildFactory",value:function(n){this.provinces.get(n.payload.province).factory=this.board.graph.get(n.payload.province).factoryType,this.nations.get(this.currentNation).treasury-=5}},{key:"rondelActions",value:function(n){var e=["factory","production1","maneuver1","investor","import","production2","maneuver2","taxation"],t=this.nations.get(n).rondelPosition,r=new Set;if(t){var a=e.indexOf(t),o=a-8;[e[a+1]||e[o+1],e[a+2]||e[o+2],e[a+3]||e[o+3]].forEach((function(e){r.add(F.rondel({nation:n,cost:0,slot:e}))})),r.add(F.rondel({nation:n,cost:2,slot:e[a+4]||e[o+4]})),r.add(F.rondel({nation:n,cost:4,slot:e[a+5]||e[o+5]})),r.add(F.rondel({nation:n,cost:6,slot:e[a+6]||e[o+6]}))}else e.forEach((function(e){r.add(F.rondel({nation:n,cost:0,slot:e}))}));return r}},{key:"nextNation",value:function(n){var e=n.when({AH:function(){return T.IT},IT:function(){return T.FR},FR:function(){return T.GB},GB:function(){return T.GE},GE:function(){return T.RU},RU:function(){return T.AH}});return this.nations.get(e).controller?e:this.nextNation(e)}},{key:"importAction",value:function(n){var e,t=new Set,r=q(this.board.byNation.get(n));try{for(r.s();!(e=r.n()).done;){var a=e.value;"shipyard"===this.board.graph.get(a).factoryType&&t.add(F.import({placements:[{province:a,unit:"fleet"}]})),t.add(F.import({placements:[{province:a,unit:"army"}]}))}}catch(n){r.e(n)}finally{r.f()}return t}},{key:"buildFactoryAction",value:function(n){return new Set(n.when({AH:function(){return["trieste","prague","lemburg"]},IT:function(){return["genoa","venice","florence"]},FR:function(){return["brest","dijon","marseille"]},GB:function(){return["dublin","sheffield","edinburgh"]},GE:function(){return["danzig","munich","cologne"]},RU:function(){return["kiev","st. petersburg","warsaw"]}}).map((function(n){return F.buildFactory({province:n})})))}},{key:"factoryCount",value:function(n){var e,t=0,r=q(this.board.byNation.get(n));try{for(r.s();!(e=r.n()).done;){var a=e.value;this.provinces.get(a).factory&&t++}}catch(n){r.e(n)}finally{r.f()}return t}}]),n}(),en=[F.initialize({players:[{id:"Daniel",nation:T.RU},{id:"Claudia",nation:T.FR},{id:"Bert",nation:T.GB},{id:"Anton",nation:T.IT}]}),F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.noop,F.rondel({nation:T.AH,cost:0,slot:"import"}),F.import({placements:[{province:"trieste",type:"fleet"},{province:"lemberg",type:"army"}]}),F.noop,F.rondel({nation:T.IT,cost:0,slot:"investor"}),F.bondPurchase({nation:T.GE,player:"Daniel",cost:4}),F.rondel({nation:T.FR,cost:0,slot:"factory"}),F.buildFactory({province:"marseille"}),F.rondel({nation:T.GB,cost:0,slot:"production1"}),F.rondel({nation:T.GE,cost:0,slot:"production2"}),F.rondel({nation:T.RU,cost:0,slot:"investor"}),F.bondPurchase({nation:T.GE,player:"Anton",cost:6}),F.rondel({nation:T.AH,cost:0,slot:"production2"}),F.rondel({nation:T.IT,cost:0,slot:"production2"}),F.rondel({nation:T.FR,cost:0,slot:"production1"}),F.rondel({nation:T.GB,cost:0,slot:"maneuver1"}),F.maneuver({origin:"liverpool",destination:"northatlantic"}),F.maneuver({origin:"london",destination:"englishchannel"}),F.rondel({nation:T.GE,cost:0,slot:"maneuver2"}),F.maneuver({origin:"hamburg",destination:"northsea"}),F.maneuver({origin:"berlin",destination:"norway"}),F.rondel({nation:T.RU,cost:0,slot:"import"}),F.import({placements:[{province:"stpetersburg",type:"fleet"},{province:"moscow",type:"army"},{province:"moscow",type:"army"}]}),F.noop,F.noop,F.rondel({nation:T.AH,cost:0,slot:"maneuver2"}),F.maneuver({origin:"trieste",destination:"ioniansea"}),F.maneuver({origin:"lemberg",destination:"romania"}),F.maneuver({origin:"budapest",destination:"westbalkan"}),F.maneuver({origin:"vienna",destination:"tunis"}),F.rondel({nation:T.IT,cost:0,slot:"maneuver2"}),F.maneuver({origin:"naples",destination:"westernmediterraneansea"}),F.maneuver({origin:"rome",destination:"spain"}),F.rondel({nation:T.FR,cost:0,slot:"maneuver1"}),F.maneuver({origin:"marseille",destination:"westernmediterraneansea"}),F.fight({province:"westernmediterraneansea",incumbent:T.IT,challenger:T.FR}),F.maneuver({origin:"bordeaux",destination:"bayofbiscay"}),F.maneuver({origin:"paris",destination:"morocco"}),F.rondel({nation:T.GB,cost:0,slot:"investor"}),F.bondPurchase({nation:T.RU,player:"Bert",cost:6}),F.rondel({nation:T.GE,cost:0,slot:"taxation"}),F.rondel({nation:T.RU,cost:0,slot:"production2"}),F.rondel({nation:T.AH,cost:0,slot:"taxation"}),F.rondel({nation:T.IT,cost:0,slot:"production1"}),F.rondel({nation:T.FR,cost:0,slot:"production2"}),F.bondPurchase({nation:T.AH,player:"Claudia",cost:6}),F.rondel({nation:T.GB,cost:0,slot:"production2"}),F.rondel({nation:T.GE,cost:0,slot:"factory"}),F.buildFactory({province:"cologne"}),F.rondel({nation:T.RU,cost:0,slot:"maneuver2"}),F.maneuver({origin:"stpetersburg",destination:"balticsea"}),F.maneuver({origin:"odessa",destination:"blacksea"}),F.maneuver({origin:"moscow",destination:"sweden"}),F.maneuver({origin:"moscow",destination:"turkey"}),F.maneuver({origin:"moscow",destination:"lemberg"})],tn=t(0),rn=t.n(tn);function an(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],r=!0,a=!1,o=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done)&&(t.push(i.value),!e||t.length!==e);r=!0);}catch(n){a=!0,o=n}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return t}(n,e)||on(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(n,e){if(n){if("string"==typeof n)return sn(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?sn(n,e):void 0}}function sn(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}Vue.component("player",{props:["name","cash","bonds","current_player"],template:'\n  <li class="player">\n    <div v-if="name === current_player" class="current_player">\n      🤩\n    </div>\n    <div class="contents">\n      <h3>{{ name }}</h3>\n      <div>Cash: {{ cash }} million</div>\n      <div>\n        Bonds:\n        <ul class="bonds">\n          <bond\n            v-for="bond in bonds"\n            v-bind:nation="bond.nation.value"\n            v-bind:cost="bond.cost"\n            v-bind:key="bond.nation.value"\n          ></bond>\n        </ul>\n      </div>\n    </div>\n  </li>\n  '}),Vue.component("bond",{props:["nation","cost"],template:'<li class="bond">{{ nation }}{{ cost }}</li>'}),Vue.component("current-turn",{props:["type","payload"],template:"<div>{{ type }}{{ payload }}</div>"}),Vue.component("action",{props:["action","dispatch","text"],template:'<button v-on:click="dispatch(action)">{{ text }}</button>'}),Vue.component("rondel",rn.a);var ln=Vue.component("app",{data:function(){return{game:{},gameStarted:!1,rondel:""}},methods:{startGame:function(){this.game=nn.fromLog(en.slice(0,2)),this.gameStarted=!0},flag:function(n){switch(n){case"AH":return"flags/ah.svg";case"IT":return"flags/it.svg";case"FR":return"flags/fr.svg";case"GB":return"flags/gb.svg";case"GE":return"flags/ge.svg";case"RU":return"flags/ru.svg"}},tickWithAction:function(n){this.game.tick(n),this.updateRondel()},actionToText:function(n){return"rondel"===n.type?n.payload.slot:"import"===n.type?"Import ".concat(n.payload.unit," in ").concat(n.payload.province):"buildFactory"===n.type?"Build factory in ".concat(n.payload.province):void 0},updateRondel:function(){var n,e=function(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=on(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return i=n.done,n},e:function(n){s=!0,o=n},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}(this.game.nations);try{for(e.s();!(n=e.n()).done;){var t=an(n.value,2),r=t[0],a=t[1].rondelPosition;if(null!==a){var o=document.getElementById(a),i=(o.getBBox(),document.createElementNS("http://www.w3.org/2000/svg","image"));i.setAttribute("height","20");for(var s=o.getTotalLength()/100,l=0,c=0,u=0;u<o.getTotalLength();u+=s){var d=o.getPointAtLength(u);l+=d.x,c+=d.y}i.setAttribute("x",l/100),i.setAttribute("y",c/100),i.setAttribute("href",this.flag(r.value)),o.parentNode.append(i)}}}catch(n){e.e(n)}finally{e.f()}}},template:'\n  <div v-if="gameStarted">\n    <ul class="players">\n      <player\n        v-for="player in game.players"\n        v-bind:name="player.name"\n        v-bind:cash="player.cash"\n        v-bind:bonds="player.bonds"\n        v-bind:current_player="game.currentPlayerName"\n        v-bind:key="player.name"\n      ></player>\n    </ul>\n    <div class="rondel">\n      <rondel />\n    </div>\n    <current-turn\n      v-bind:type="game.log[game.log.length - 1].type"\n      v-bind:payload="game.log[game.log.length - 1].payload"\n    ></current-turn>\n    <div>\n      It is {{ game.currentNation.value }}\'s turn\n    </div>\n    <div class="buttons">\n      <action\n        v-for="action in game.availableActions"\n        v-bind:key="JSON.stringify(action)"\n        v-bind:action="action"\n        v-bind:text="actionToText(action)"\n        v-bind:dispatch="tickWithAction"\n      ></action>\n    </div>\n  </div>\n  <div v-else class="buttons">\n    <button v-on:click="startGame">\n      Start Game\n    </button>\n  </div>\n'});t(2);new Vue({el:"#app",render:function(n){return n(ln)}})}]);